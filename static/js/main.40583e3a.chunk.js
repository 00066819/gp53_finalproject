(this["webpackJsonpposts-app"]=this["webpackJsonpposts-app"]||[]).push([[0],{289:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(121),s=n.n(c),o=(n(71),n(3)),i=n.n(o),u=n(6),l=n(4),d=n(2),p=n(5),j=n(46),b=n(47),f=n.n(b),x="https://posts-pw2021.herokuapp.com/api/v1",O="token";function m(e,t){var n,r=Object(j.a)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!e.has(a))return!1}}catch(c){r.e(c)}finally{r.f()}return!0}var h=function(e){try{var t;return(null===(t=JSON.parse(localStorage.getItem(O)))||void 0===t?void 0:t.token)||null}catch(n){return null}},v=function(){var e=Object(u.a)(i.a.mark((function e(t,n,r){var a,c,s,o,u,l=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(l.length>3&&void 0!==l[3])||l[3],c=h(),!a||c){e.next=4;break}throw new Error("Expected token.");case 4:return e.prev=4,s=Object(p.a)({method:t.toUpperCase(),headers:Object(p.a)({"Content-type":"application/json"},a&&{Authorization:"Bearer ".concat(c)})},r&&Object.keys(r).length&&{body:JSON.stringify(r)}),e.next=8,fetch("".concat(x).concat(n),s);case 8:return o=e.sent,e.next=11,o.json();case 11:if(u=e.sent,!o.ok){e.next=16;break}return e.abrupt("return",u);case 16:throw new Error("An error has occurred",{cause:u});case 17:e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(4),console.error(e.t0),new Error("An error has occurred",{cause:(null===e.t0||void 0===e.t0?void 0:e.t0.cause)||e.t0});case 23:case"end":return e.stop()}}),e,null,[[4,19]])})));return function(t,n,r){return e.apply(this,arguments)}}();function g(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{className:t.map((function(e){var t;return null===e||void 0===e||null===(t=e.toString)||void 0===t?void 0:t.call(e)})).filter(Boolean).join(" ")}}g.children=function(e){return e.split(" ").map((function(e){return"children:"+e})).join(" ")};var y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return v("get","/post/all?limit=".concat(15,"&page=").concat(e))},w=function(e){return v("get","/post/one/".concat(e))},k=function(e,t,n){return v("post","/post/create",{title:e,description:t,image:n})},N=function(e,t,n,r){return v("put","/post/update/".concat(e),{title:t,description:n,image:r})},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return v("get","/post/owned?limit=".concat(15,"&page=").concat(e))},E=n(122),P=n(1);function C(){return Object(P.jsx)(E.BounceLoader,{size:72,color:"orange",loading:!0})}function _(){return Object(P.jsx)("div",{className:"flex h-screen w-screen justify-center items-center",children:Object(P.jsx)(C,{})})}var I=n(11),M=function(e,t){return v("post","/auth/signin",{username:e,password:t},!1)},L=a.a.createContext(),A={user:new Set(["post:read"]),admin:new Set(["post:read","admin:read","post:create","post:update","admin:update","post:delete"])},F=function(e){var t=Object(r.useReducer)(D,h()),n=Object(l.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(h()?"loading":null),o=Object(l.a)(s,2),d=o[0],j=o[1];Object(r.useEffect)((function(e){if(a&&"loading"!==a){var t=function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=13;break}return e.prev=1,e.next=4,v("get","/auth/whoami");case 4:n=e.sent,j(n),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(1),j(null),c(null);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();t()}}),[a]);var b=Object(r.useRef)(function(){var e=Object(u.a)(i.a.mark((function e(t,n){var r,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,e.prev=1,e.next=4,M(t,n);case 4:a=e.sent,(s=a.token)&&(c(s),r=!0),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0),console.error("Error in login");case 13:return e.prev=13,e.abrupt("return",r);case 16:case"end":return e.stop()}}),e,null,[[1,9,13,16]])})));return function(t,n){return e.apply(this,arguments)}}()),f=Object(r.useRef)((function(e){j(void 0),c(void 0)})),x=Object(r.useMemo)((function(e){return{token:a,user:d,login:b.current,logout:f.current,permissions:(null===d||void 0===d?void 0:d.role)?A[d.role]:null}}),[a,d]);return Object(P.jsx)(L.Provider,Object(p.a)({value:x},e))},R=function(e){var t=a.a.useContext(L);if(!t)throw new Error("useUserContext() must be inside of UserProvider");return t};function D(e,t){return localStorage.setItem(O,JSON.stringify({token:t})),t}function U(e){var t=e.name,n=Object(d.g)(),a=R(),c=a.logout,s=a.permissions;return Object(P.jsxs)("header",{className:"sticky",children:[t&&Object(P.jsx)("div",{className:"bg-yellow-500 p-4",children:Object(P.jsx)("h1",{className:"text-2xl font-extrabold text-gray-900 ml-4",children:t})}),Object(P.jsxs)("div",{className:"relative h-full flex justify-center items-center bg-yellow-600 shadow",children:[Object(P.jsx)(I.b,{to:"/dashboard",className:"bg-yellow-600 hover:bg-yellow-700 text-gray-900 font-bold py-2 px-4",children:"Home"}),Object(P.jsx)(I.b,{to:"/user",className:"bg-yellow-600 hover:bg-yellow-700 text-gray-900 font-bold py-2 px-4",children:"My Account"}),m(s,new Set(["post:update"]))&&Object(P.jsxs)(r.Fragment,{children:[Object(P.jsx)(I.b,{to:"/my-posts",className:"bg-yellow-600 hover:bg-yellow-700 text-gray-900 font-bold py-2 px-4",children:"My Posts"}),Object(P.jsx)(I.b,{to:"/create-post",className:"bg-yellow-600 hover:bg-yellow-700 text-gray-900 font-bold py-2 px-4",children:"Create Post"})]}),Object(P.jsx)("button",{onClick:function(){c(),n("/login")},className:"absolute right-2 text-right",children:Object(P.jsx)("span",{className:"material-icons",children:"logout"})})]})]})}var B=n(123),J=n.n(B);function W(e){var t=e.data,n=e.setPage,a=e.children,c=g("text-center",g.children("p-1 not-last:border-r-2 w-4"));return Object(P.jsxs)(r.Fragment,{children:[Object(r.cloneElement)(a,{elements:t.values}),t.pages>1&&Object(P.jsx)("div",Object(p.a)(Object(p.a)({},c),{},{children:J()(Math.max(t.page-4,0),Math.min(Math.max(t.page+4,9),t.pages)).map((function(e){return Object(P.jsx)("button",{onClick:function(t){return n(e)},disabled:t.page===e,className:t.page===e?"bg-secondary":"bg-additional",children:e+1},e)}))}))]})}var T=n(16),V=n(124),z=n.n(V),H=n(125),q=n.n(H);function G(){var e=Object(r.useState)(null),t=Object(l.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(e){n||(a("loading"),function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v("get","/post/fav");case 2:n=e.sent.favorites,a(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()())}),[n]),n}function K(e){var t=e.post,n=e.updatePost,a=e.useLink,c=void 0!==a&&a,s=e.className,o=e.style,d=R(),j=d.user,b=d.permissions,x=G(),O=Object(r.useState)(!1),h=Object(l.a)(O,2),y=h[0],w=h[1],k=Object(r.useState)(null),S=Object(l.a)(k,2),E=S[0],C=S[1];Object(r.useEffect)((function(e){x&&"loading"!==x&&C(x.includes(t._id))}),[x]);var _=Object(r.useState)(!1),M=Object(l.a)(_,2),L=M[0],A=M[1],F=Object(r.useState)(!1),D=Object(l.a)(F,2),U=D[0],B=D[1],J=Object(r.useState)(null),W=Object(l.a)(J,2),V=W[0],H=W[1];Object(r.useEffect)((function(e){t&&"loading"!==t&&H(Boolean(t.likes.find((function(e){return e.username===j.username}))))}),[t]);var K=Object(r.useState)(!1),Y=Object(l.a)(K,2),Z=Y[0],$=Y[1],ee=Object(r.useState)(!1),te=Object(l.a)(ee,2),ne=te[0],re=te[1],ae=Object(r.useState)(t.active),ce=Object(l.a)(ae,2),se=ce[0],oe=ce[1];Object(r.useEffect)((function(e){oe(t.active)}),[t.active]);var ie=Object(r.useState)(!1),ue=Object(l.a)(ie,2),le=ue[0],de=ue[1],pe=Object(r.useState)(!1),je=Object(l.a)(pe,2),be=je[0],fe=je[1],xe=c?I.b:"div",Oe=g("transition duration-200 relative border-4 border-additional rounded rounded-xl bg-white h-96 hover:shadow-2xl"),me=g("flex-row absolute m-2 leading-none bottom-0",g.children("transition duration-200 bg-gray-300 text-black not-last:mr-1 rounded p-1 hover:bg-yellow-500 active:bg-secondary-light")),he=Object(P.jsxs)(r.Fragment,{children:[Object(P.jsxs)(xe,Object(p.a)(Object(p.a)({},c&&{to:"/post/".concat(t._id)}),{},{className:"flex flex-col",children:[Object(P.jsx)("h3",{className:"text-xl font-extrabold text-center text-gray-800",children:t.title}),Object(P.jsx)("img",{src:t.image,alt:"Post ".concat(t._id),className:"my-2 m-auto object-contain",style:{maxHeight:"200px"}}),Object(P.jsx)("p",{className:"text-center",children:t.description})]})),Object(P.jsxs)("div",Object(p.a)(Object(p.a)({},g(me.className,"left-0")),{},{children:[Object(P.jsx)("button",Object(p.a)(Object(p.a)({className:"material-icons"},Q(function(){var e=Object(u.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n=t._id,v("patch","/post/like/".concat(n));case 3:H((function(e){return!e})),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.dir(e.t0);case 9:case"end":return e.stop()}var n}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),$,re)),{},{children:V^(Z&&!ne)?"favorite":"favorite_outline"})),Object(P.jsx)("button",Object(p.a)(Object(p.a)({className:"material-icons"},Q(function(){var e=Object(u.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n=t._id,v("patch","/post/fav/".concat(n));case 3:C((function(e){return!e})),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.dir(e.t0);case 9:case"end":return e.stop()}var n}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),A,B)),{},{children:E^(L&&!U)?"star":"star_outline"}))]})),n&&m(b,X)&&Object(P.jsxs)("div",Object(p.a)(Object(p.a)({},g(me.className,"right-0")),{},{children:[Object(P.jsx)("button",{className:"material-icons",onClick:function(e){return w(!0)},children:"edit"}),Object(P.jsx)("button",Object(p.a)(Object(p.a)({className:"material-icons"},Q(function(){var e=Object(u.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n=t._id,v("patch","/post/toggle/".concat(n));case 3:oe((function(e){return!e})),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.dir(e.t0);case 9:case"end":return e.stop()}var n}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),de,fe)),{},{children:se^(le&&!be)?"visibility":"visibility_off"}))]}))]}),ve=function(){var e=Object(u.a)(i.a.mark((function e(r){var a,c,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),a=["title","description","image"],s=(c=function(e){return a.map((t=e,function(e){return f()(e)(t)}));var t})(r.target).map(f()("value")),!!z()(s,c(t))){e.next=16;break}return e.prev=6,e.next=9,N.apply(void 0,[t._id].concat(Object(T.a)(s)));case 9:n(t._id,q()(a,(function(e,t,n){return e[t]=s[n]}),{})),w(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t){return e.apply(this,arguments)}}(),ge=g("bg-gray-200 rounded not-last:mb-2 p-1"),ye=Object(P.jsxs)("form",{onSubmit:ve,className:"flex flex-col",children:[Object(P.jsx)("input",Object(p.a)({name:"title",placeholder:"Title",defaultValue:t.title,type:"text"},ge)),Object(P.jsx)("input",Object(p.a)({name:"image",placeholder:"Image URL",defaultValue:t.image,type:"text"},ge)),Object(P.jsx)("textarea",Object(p.a)({name:"description",placeholder:"Description",defaultValue:t.description,rows:4},ge)),Object(P.jsxs)("div",Object(p.a)(Object(p.a)({},g(me.className,"right-0")),{},{children:[Object(P.jsx)("button",{className:"material-icons",onClick:function(e){return w(!1)},children:"cancel"}),Object(P.jsx)("button",{className:"material-icons",type:"submit",children:"check"})]}))]});return Object(P.jsx)("div",Object(p.a)(Object(p.a)({},g(s,Oe.className)),{},{style:o,children:y?ye:he}))}var Q=function(e,t,n){return{onClick:function(){e(),n(!0)},onMouseEnter:function(){t(!0)},onMouseLeave:function(){t(!1),n(!1)}}},X=new Set(["post:update"]);function Y(e){var t=Object(d.f)(),n=Object(d.g)(),a=Object.fromEntries(t.search.slice(1).split("&").map((function(e){return e.split("=")}))),c=Object(r.useReducer)($,{load:a.page&&parseInt(a.page)?parseInt(a.page)-1:0}),s=Object(l.a)(c,2),o=s[0],p=s[1];return Object(r.useEffect)((function(e){if(o&&"loading"!==o&&"load"in o)return p({type:"loading"}),void function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=p,e.next=3,y(o.load);case 3:e.t1=e.sent,e.t2={type:"load",payload:e.t1},(0,e.t0)(e.t2);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()();o||(p({type:"loading"}),function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=p,e.next=4,y();case 4:e.t1=e.sent,e.t2={type:"load",payload:e.t1},(0,e.t0)(e.t2),e.next=12;break;case 9:e.prev=9,e.t3=e.catch(0),p({type:"error",payload:e.t3});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()())}),[o]),o&&"loading"!==o?Object(P.jsxs)("section",{className:"justify-around items-center min-h-screen bg-gray-300",children:[Object(P.jsx)(U,{}),Object(P.jsx)(W,{data:o,setPage:function(e){n("/dashboard?page=".concat(e+1)),p({type:"page",payload:{i:e}})},children:Object(P.jsx)(Z,{})})]}):Object(P.jsx)(_,{})}function Z(e){var t=e.elements;return Object(P.jsx)("div",{className:"grid grid-cols-3 gap-4 p-8",children:null===t||void 0===t?void 0:t.map((function(e){return Object(P.jsx)(K,{post:e,useLink:!0},e._id)}))})}function $(e,t){var n=t.type,r=t.payload;return"load"===n?{values:r.data,limit:r.limit,page:r.page,pages:r.pages}:"loading"===n?"loading":"error"===n?{error:r}:"page"===n?{load:r.i}:e}function ee(){var e=R().login,t=Object(r.useState)(""),n=Object(l.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(""),o=Object(l.a)(s,2),d=o[0],p=o[1],j=Object(r.useState)(!1),b=Object(l.a)(j,2),f=b[0],x=b[1],O=function(e,t){t(e.target.value)},m=function(){var t=Object(u.a)(i.a.mark((function t(n){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,e(a,d);case 4:r=t.sent,t.next=12;break;case 7:t.prev=7,t.t0=t.catch(1),x(!r),c(""),p("");case 12:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}();return Object(P.jsx)("div",{className:"flex justify-center items-center min-h-screen bg-login-img bg-cover",children:Object(P.jsx)("main",{className:"w-1/2 max-w-sm bg-gray-900 rounded-md p-8 md:p-10 shadow-md",children:Object(P.jsxs)("form",{onSubmit:m,className:"flex flex-col gap-4 items-center justify-center",children:[Object(P.jsx)("h2",{className:"uppercase text-primary font-medium font-roboto font-black text-4xl mb-4",children:"Posts App"}),f&&Object(P.jsx)("p",{className:"w-full rounded p-3 text-center text-white font-roboto bg-red-700 select-none",children:"An error occurred. Please try again."}),Object(P.jsx)("input",{className:"font-medium bg-gray-700 w-full text-yellow-500 focus:outline-none focus:ring p-2 rounded",type:"text",value:a,placeholder:"Username",onChange:function(e){return O(e,c)}}),Object(P.jsx)("input",{className:"font-medium bg-gray-700 w-full text-yellow-500 focus:outline-none focus:ring p-2 rounded",type:"password",placeholder:"Password",onChange:function(e){return O(e,p)},value:d}),Object(P.jsx)("button",{className:"mt-6 w-md transition rounded duration-300 ease-in-out text-xl text-extrabold uppercase bg-primary hover:bg-primary-dark py-2 px-4 text-gray-100",children:"Sign In "})]})})})}function te(){Object(d.g)();var e=R().user,t=G(),n=Object(r.useState)(null),a=Object(l.a)(n,2),c=a[0],s=a[1];return Object(r.useEffect)((function(e){t&&"loading"!==t&&!c&&(s([]),t.forEach((function(e,t){!function(){var n=Object(u.a)(i.a.mark((function n(r){var a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s((function(e){var n=Object(T.a)(e);return n[t]="loading",n})),n.prev=1,n.next=4,w(e);case 4:a=n.sent,s((function(e){var n=Object(T.a)(e);return n[t]=a,n})),n.next=10;break;case 8:n.prev=8,n.t0=n.catch(1);case 10:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e){return n.apply(this,arguments)}}()()})))}),[t,c]),Object(P.jsxs)("section",{className:"justify-around items-center min-h-screen bg-gray-300",children:[Object(P.jsx)(U,{name:e.username}),Object(P.jsx)("h3",{className:"text-xl m-8 bold",children:"My Favorites"}),Object(P.jsx)("div",{className:"grid grid-cols-3 gap-4 m-8",children:null===c||void 0===c?void 0:c.map((function(e){return Object(P.jsx)(K,{post:e,useLink:!0},e._id)}))})]})}function ne(){return Object(P.jsx)("p",{children:"Not Found"})}var re=n(48),ae=n.n(re);function ce(){var e=Object(d.h)().id,t=Object(d.g)(),n=Object(r.useState)(null),a=Object(l.a)(n,2),c=a[0],s=a[1];return Object(r.useEffect)((function(n){e&&!c&&(s("loading"),function(){var n=Object(u.a)(i.a.mark((function n(r){var a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,w(e);case 3:a=n.sent,s(a),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),t("/404");case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e){return n.apply(this,arguments)}}()())}),[t,c,e]),c&&"loading"!==c?Object(P.jsxs)(r.Fragment,{children:[Object(P.jsx)(U,{}),Object(P.jsx)("div",{className:"mt-8",children:Object(P.jsx)(K,{post:c,updatePost:function(e,t){if("object"===typeof t){var n=t;t=function(e){return ae()(e,n)}}else if("function"!==typeof t)throw new Error("Expected update function or object");return s(t)},className:"m-auto",style:{maxWidth:"400px"}})})]}):Object(P.jsx)(_,{})}var se=n(127),oe=n(126),ie=n.n(oe);function ue(){var e=Object(d.f)(),t=Object(d.g)(),n=Object.fromEntries(e.search.slice(1).split("&").map((function(e){return e.split("=")}))),a=Object(r.useReducer)(de,{load:n.page&&parseInt(n.page)?parseInt(n.page)-1:0}),c=Object(l.a)(a,2),s=c[0],o=c[1];return Object(r.useEffect)((function(e){if(s&&"loading"!==s&&"load"in s)return o({type:"loading"}),void function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=o,e.next=3,S(s.load);case 3:e.t1=e.sent,e.t2={type:"load",payload:e.t1},(0,e.t0)(e.t2);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()();s||(o({type:"loading"}),function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=o,e.next=4,S();case 4:e.t1=e.sent,e.t2={type:"load",payload:e.t1},(0,e.t0)(e.t2),e.next=12;break;case 9:e.prev=9,e.t3=e.catch(0),o({type:"error",payload:e.t3});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()())}),[s]),s&&"loading"!==s&&"error"in s?"error":Object(P.jsxs)("section",{className:"justify-around items-center min-h-screen bg-gray-300",children:[Object(P.jsx)(U,{name:"My Posts"}),s&&"loading"!==s?Object(P.jsx)(W,{data:s,setPage:function(e){t("/my-posts?page=".concat(e+1)),o({type:"page",payload:{i:e}})},children:Object(P.jsx)(le,{updatePost:function(e,t){if("object"===typeof t){var n=t;t=function(e){return ae()(e,n)}}else if("function"!==typeof t)throw new Error("Expected update function or object");return o({type:"update-post",payload:{id:e,update:t}})}})}):Object(P.jsx)(C,{})]})}function le(e){var t=e.elements,n=e.updatePost;return Object(P.jsx)("div",{className:"grid grid-cols-3 gap-4 p-8",children:null===t||void 0===t?void 0:t.map((function(e){return Object(P.jsx)(K,{post:e,updatePost:n,useLink:!0},e._id)}))})}function de(e,t){var n=t.type,r=t.payload;return"load"===n?{values:r.data,limit:r.limit,page:r.page,pages:r.pages}:"loading"===n?"loading":"error"===n?{error:r}:"page"===n?{load:r.i}:"update-post"===n&&"posts"in e&&["id","update"].every((function(e){return e in r}))?Object(se.a)(e,(function(e){var t=e.posts.findIndex((function(e){return e._id===r.id}));-1!==t&&(e.posts[t]=r.update(e.posts[t]),console.log(1,t,ie()(e.posts)))})):e}function pe(e){R().logout;var t=Object(d.g)(),n=Object(r.useState)(""),a=Object(l.a)(n,2),c=a[0],s=a[1],o=Object(r.useState)(""),j=Object(l.a)(o,2),b=j[0],f=j[1],x=Object(r.useState)(""),O=Object(l.a)(x,2),m=O[0],h=O[1],v=Object(r.useState)(null),g=Object(l.a)(v,2),y=g[0],w=g[1],N=function(){var e=Object(u.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),w(null),e.prev=2,e.next=5,k(c,b,m);case 5:return t("/my-posts"),e.abrupt("return");case 9:if(e.prev=9,e.t0=e.catch(2),w(je),e.t0.cause){e.next=15;break}return console.error(e.t0),e.abrupt("return");case 15:e.t0.cause.errors.forEach((function(e){e.startsWith("Title")?w((function(t){return Object(p.a)(Object(p.a)({},t),{},{title:[].concat(Object(T.a)(t.title),[e])})})):e.startsWith("Description")?w((function(t){return Object(p.a)(Object(p.a)({},t),{},{description:[].concat(Object(T.a)(t.description),[e])})})):e.startsWith("Image")&&w((function(t){return Object(p.a)(Object(p.a)({},t),{},{image:[].concat(Object(T.a)(t.image),[e])})}))}));case 16:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(P.jsxs)("section",{className:"justify-center items-center min-h-screen bg-gray-300",children:[Object(P.jsx)(U,{name:"Create Post"}),Object(P.jsx)("div",{className:"flex border-4 border-additional rounded rounded-xl bg-white mx-auto my-20 w-96 h-96 justify-center items-center",children:Object(P.jsxs)("form",{onSubmit:N,className:"flex flex-col w-full mx-2 items-center",children:[Object(P.jsx)("h2",{className:"uppercase text-primary font-medium font-roboto font-black text-4xl mb-4",children:"Create post"}),Object(P.jsxs)("div",{children:[Object(P.jsx)("input",{type:"text",placeholder:"Title",value:c,onChange:function(e){s(e.target.value)},className:"font-medium border-2 border-gray-700 w-72 text-yellow-500 focus:outline-none focus:ring p-2 rounded"}),Object(P.jsx)("span",{children:null===y||void 0===y?void 0:y.title.map((function(e,t){return Object(P.jsx)("div",{children:e},t)}))})]}),Object(P.jsxs)("div",{children:[Object(P.jsx)("textarea",{placeholder:"Description",value:b,onChange:function(e){f(e.target.value)},className:"font-medium border-2 border-gray-700 w-72 text-yellow-500 focus:outline-none focus:ring p-2 rounded mt-1.5"}),Object(P.jsx)("span",{children:null===y||void 0===y?void 0:y.description.map((function(e,t){return Object(P.jsx)("div",{children:e},t)}))})]}),Object(P.jsxs)("div",{children:[Object(P.jsx)("input",{type:"text",placeholder:"Enter an image URL",value:m,onChange:function(e){h(e.target.value)},className:"font-medium border-2 border-gray-700 w-72 text-yellow-500 focus:outline-none focus:ring p-2 rounded"}),Object(P.jsx)("span",{children:null===y||void 0===y?void 0:y.image.map((function(e,t){return Object(P.jsx)("div",{children:e},t)}))})]}),Object(P.jsx)("button",{type:"submit",className:"mt-6 w-sm transition rounded duration-300 ease-in-out text-xl text-extrabold uppercase bg-primary hover:bg-primary-dark py-2 px-4 text-gray-100",children:"Create"})]})})]})}var je=function(e){return{title:[],description:[],image:[]}};function be(e){var t=e.permissions,n=e.children,r=R(),a=r.token,c=r.user,s=r.permissions;return[a,c].some((function(e){return"loading"===e}))?Object(P.jsx)(_,{}):a&&c?t&&!m(s,t)?Object(P.jsx)(d.a,{replace:!0,to:"/404"}):n:Object(P.jsx)(d.a,{replace:!0,to:"/login"})}function fe(e){var t=e.children,n=R(),r=n.token,a=n.user;return r?a&&"loading"!==a?Object(P.jsx)(d.a,{replace:!0,to:"/dashboard"}):Object(P.jsx)(_,{}):t}function xe(){return Object(P.jsx)(I.a,{children:Object(P.jsxs)(d.d,{children:[Object(P.jsx)(d.b,{exact:!0,path:"/",element:Object(P.jsx)(fe,{children:Object(P.jsx)(d.a,{to:"/login"})})}),Object(P.jsx)(d.b,{exact:!0,path:"/login",element:Object(P.jsx)(fe,{children:Object(P.jsx)(ee,{})})}),Object(P.jsx)(d.b,{exact:!0,path:"/dashboard",element:Object(P.jsx)(be,{children:Object(P.jsx)(Y,{})})}),Object(P.jsx)(d.b,{exact:!0,path:"/user",element:Object(P.jsx)(be,{children:Object(P.jsx)(te,{})})}),Object(P.jsx)(d.b,{exact:!0,path:"/post/:id",element:Object(P.jsx)(be,{permissions:Oe.post,children:Object(P.jsx)(ce,{})})}),Object(P.jsx)(d.b,{exact:!0,path:"/my-posts",element:Object(P.jsx)(be,{permissions:Oe.myPosts,children:Object(P.jsx)(ue,{})})}),Object(P.jsx)(d.b,{exact:!0,path:"/create-post",element:Object(P.jsx)(be,{permissions:Oe.createPost,children:Object(P.jsx)(pe,{})})}),Object(P.jsx)(d.b,{path:"*",element:Object(P.jsx)(ne,{})})]})})}var Oe={post:new Set(["post:read"]),myPosts:new Set(["post:read","post:update"]),createPost:new Set(["post:create"]),admin:new Set(["admin:read"])};s.a.render(Object(P.jsx)(a.a.StrictMode,{children:Object(P.jsx)(P.Fragment,{children:Object(P.jsx)(F,{children:Object(P.jsx)(xe,{})})})}),document.getElementById("root"))},71:function(e,t,n){}},[[289,1,2]]]);
//# sourceMappingURL=main.40583e3a.chunk.js.map